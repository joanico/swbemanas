{% extends 'base.html' %}

{% block content %}
<!--Carousel Wrapper-->
<div class="container detail">
    <a href="{% url 'blog' %}" class="btn btn-default">Fila</a>
    <div class="row">
        <div class="col-md-8 display-all-posts">
            <p class="description-text">{{ post.descriptions|safe|truncatewords_html:5000000 }}</p>
            {% for p in photos %}
                <div class="card my-4">
                    <div class="card-thumbnail">
                        {% if p.images %}
                        <a href="javascript:void(0);" class="" data-toggle="modal" data-target="#tutorialsplaneModal_{{ p.id }}">
                                <img src="{{p.images.url }}" class="img-detail" alt="Image">
                                <p class="label-image">{{ p.name }}</h4>
                            </a>
                        {% else %}
                            <video width="530" height="440" controls autoplay>
                                <source src="{{ p.images.url }}" type="video/mp4"> </source>
                            </video>
                            <h3>Iha ne'e la iha photo</h3>
                        {% endif %}
                    </div>
                  </div>
            </div>
            <!-- display modal -->
            <div id="tutorialsplaneModal_{{ p.id }}" class="modal fade" role='dialog'>
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                       <h4 class="modal-title">{{ p.name }}</h4>
                        </div>
                        <div class="modal-body">
                            <img src="{{ p.images.url }}" style="width:100%;height:auto;">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Taka</button>
                        </div>
                    </div>
                  </div>
              </div>
            {% endfor %}
            <div class="col-md-4 display-all-comments">
                <!-- Comments Form -->
                <button type="button" onclick="document.getElementById('show').style.display='block'"value="ShowMe" class="btn btn-info">Add new comment</button>
                <!-- Comments Form -->
                <form action="." id="show" style="display:none" method="post">
                    {{ comment_form.as_p }}
                    {% csrf_token %}
                    <button class="add-button" type="submit">Add comment</button>
                </form>

                <!-- Comment with nested comments -->
                <div class="comment">
                    {% for comment in comments %}
                        <div class="commented">
                            <p class="info">{{ comment.name }} | {{ comment.created }}</p>
                                {{ comment.body|linebreaks }}

                            {% for replay in comment.replies.all %}
                                <p class="info">{{ replay.name }} | {{ replay.created }}</p>
                                <li>{{ replay.body }}</li>
                            {% endfor %}
                            <p>
                                <input type="button" value="Replay" id="bt" onclick="toggle(this)">
                            </p>
                       </div>
                            <div style="padding:10px; display:none;" id="cont">
                                <form action="." method="post">
                                    {{ comment_form.as_p }}
                                    {% csrf_token %}
                                    <!-- Hidden input for parent comment.id -->
                                    <input type="hidden" name="parent_id" value="{{ comment.id }}">
                                    <input class="btn btn-primary" type="submit" value="Replay">
                                </form>
                            </div>
                    {% empty %}
                    <h4>There are no comments yet.</h4>
                    {% endfor %}
                </div>
        </div>
</div>
<script>
    function toggle(ele) {
        var cont = document.getElementById('cont');
        if (cont.style.display == 'block') {
            cont.style.display = 'none';

            document.getElementById(ele.id).value = 'Replay';
        }
        else {
            cont.style.display = 'block';
            document.getElementById(ele.id).value = 'Unreplay';
        }
    }
</script>
{% endblock %}

